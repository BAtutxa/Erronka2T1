<app-menu></app-menu>

<ion-content [fullscreen]="true">
  <div class="search-container">
    <ion-searchbar
      placeholder="Buscar en {{ currentSection === 'grupos' ? 'grupos' : 'langileak' }}"
      (ionInput)="filterItems($event)"
    ></ion-searchbar>
  </div>

  <div class="toggle-container">
    <ion-segment [(ngModel)]="currentSection" (ionChange)="segmentChanged()">
      <ion-segment-button value="grupos">
        Grupos
      </ion-segment-button>
      <ion-segment-button value="langileak">
        Langileak
      </ion-segment-button>
    </ion-segment>
  </div>

  <div class="item-grid">
    <ng-container *ngIf="filteredItems.length; else noItems">
      <ion-card
        class="item-card"
        *ngFor="let item of filteredItems"
        (click)="showItemDetails(item)"
      >
        <ion-card-header>
          <ion-card-title>{{ item.name }}</ion-card-title>
        </ion-card-header>
      </ion-card>
    </ng-container>
    <ng-template #noItems>
      <p class="no-items">No hay {{ currentSection }} disponibles.</p>
    </ng-template>
  </div>

  <ion-modal [isOpen]="isModalOpen" (didDismiss)="closeItemDetails()">
    <ng-container *ngIf="selectedItem">
      <ion-header>
        <ion-toolbar>
          <ion-title>{{ selectedItem.name }}</ion-title>
          <ion-buttons slot="end">
            <ion-button (click)="closeItemDetails()">
              <ion-icon name="close"></ion-icon>
            </ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>
  
      <ion-content>
        <div class="item-details" *ngIf="currentSection === 'grupos'">
          <p><strong>CÃ³digo:</strong> {{ selectedItem.kodea }}</p>
          <h3>Langileak en este grupo:</h3>
          <ul>
            <li *ngFor="let langile of selectedItem.langileak">{{ langile.name }} {{ langile.surname }}</li>
          </ul>
        </div>

        <div class="item-details" *ngIf="currentSection === 'langileak'">
          <p><strong>Nombre:</strong> {{ selectedItem.name }}</p>
          <p><strong>Apellidos:</strong> {{ selectedItem.surname }}</p>
          <p><strong>Grupo:</strong> {{ selectedItem.grupo?.name || 'No asignado' }}</p>
        </div>
      </ion-content>
    </ng-container>
  </ion-modal>
</ion-content>
